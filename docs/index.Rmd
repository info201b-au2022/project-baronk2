---
title: "Child Mortality: Global Causes of Death"
authors: Jonathan To- jto9331@uw.edu
         Hiba Abbas- hibaa3@uw.edu
         Kevin Baron- baronk2@uw.edu
date: "11/14/2022"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
```


```{r}
source("../source/aggregated_table.R")
source("../source/dynamic_paragraph_stats.R")
source("../source/chart_1.R")
source("../source/chart_2.R")
# source("../source/map-chart-3.R")
```


## Aggregated Table

```{r table, echo = FALSE} 
  aggregated_table
``` 



## Dynamic Paragraph

```{r dynamic_paragraph, echo = FALSE}

most_recent_leading_cause = get_most_recent_leading_cause()

most_recent_leading_cause_total_deaths = get_most_recent_leading_cause_total_deaths()

most_recent_trailing_cause = get_most_recent_trailing_cause()

most_recent_trailing_cause_total_deaths = get_most_recent_trailing_cause_total_deaths()

most_recent_leading_cause_leading_country = get_most_recent_leading_cause_leading_country()

most_recent_leading_cause_leading_country_deaths = get_most_recent_leading_cause_leading_country_deaths()

```

The most recently recorded leading cause of death for children 0-4 years old is 
`r most_recent_leading_cause`, resulting in `r prettyNum(most_recent_leading_cause_total_deaths, big.mark = ",")` deaths. On the other hand, the disease causing the least number of deaths is `r most_recent_trailing_cause` with `r prettyNum(most_recent_trailing_cause_total_deaths, big.mark = ",")` child deaths. When looking at `r most_recent_leading_cause`, the country leading this death toll is `r most_recent_leading_cause_leading_country` with a numerical value of `r prettyNum(most_recent_leading_cause_leading_country_deaths, big.mark = ",")`.


## Chart 1

Here is a bar chart showcasing the correlation between the 13 causes of infant deaths and number of deaths in 2017.


```{r echo=FALSE, message=FALSE}
library(ggplot2)
# Create data
data <- data.frame(
  Diseases=c("HIV/AIDS","Diarrhoeal","Measles","Meningitis","Malaria","Respiratory","Prematurity","Birth Asphyxia","Sepsis","Nutritional","Congenital","Other diseases","Injuries") ,  
  Deaths=c(2951383,13548674,4331460,4185463,8714325,22424319,20972323,15838560,7699710,11486173,9430762,5214289,6923513)
)
# Barplot

p<-ggplot(data, aes(x=Diseases, y=Deaths, fill=Diseases)) +
  geom_bar(stat="identity", width = 0.5) 
p
```


## Chart 2

Here is a pi chart showcasing the amount of deaths for each of the 13 causes in 2017.

```{r echo=FALSE, message=FALSE}
source("https://raw.github.com/info201b-au2022/project-baronk2/main//source/chart_2.R")

 ggplot(deaths_in_test, aes(x="", y=deaths, fill=cause)) +
  geom_bar(stat="identity", width=1, color="black") +
  coord_polar("y", start=0) +

  theme_void()

```


## Chart 3

Here is a map showing where there have been the most child deaths globally from
2000 to 2017.

<!-- ```{r map, echo=FALSE, message=FALSE} -->
<!-- get_deaths_map() -->
<!-- get_deaths_map_paragraph() -->
<!-- ``` -->
